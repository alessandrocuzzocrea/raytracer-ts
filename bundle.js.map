{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/color.ts","webpack:///./src/vec3.ts","webpack:///./src/main.ts","webpack:///./src/raytracer.ts","webpack:///./src/viewport.ts","webpack:///./src/ray.ts","webpack:///./src/sphere.ts","webpack:///./src/hitinfo.ts","webpack:///./src/consts.ts","webpack:///./src/light.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","g","b","this","Red","Color","Black","Magenta","x","y","z","Zero","Vec3","Length","a","Math","pow","sqrt","Normalized","length","Add","v","Subtract","ScalarMultiply","k","Dot","Raytracer","render","width","height","div","document","createElement","body","append","viewport","Viewport","clearButton","innerText","onclick","clear","appendChild","fillRandomButton","fillRandom","renderButton","saveToPNGButton","saveToPNG","parent","canvas","context","getContext","sphere","Sphere","light","Light","fillStyle","fillRect","imageData","getImageData","data","random","putImageData","ratio","dirX","dirY","ray","Ray","offset","hitInfo","intersect","hit","pointToLight","position","hitPoint","intensity","max","normal","hitInfoColor","GetColor","window","open","innerHTML","toDataURL","origin","direction","CalcPointAtT","radius","color","x_o","y_o","z_o","x_d","y_d","z_d","x_c","y_c","z_c","A","B","C","discriminant","t_0","x_i","y_i","z_i","HitInfo","Consts","DEBUG_NORMALS"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","import { Vec3 } from \"./vec3\";\n\nexport class Color {\n    r: number;\n    g: number;\n    b: number;\n\n    constructor(r:number, g:number, b:number) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n\n    public static Red(): Color {\n        return new Color(231, 76, 60);\n    }\n\n    public static Black(): Color {\n        return new Color(44, 62, 80);\n    }\n\n    public static Magenta(): Color {\n        return new Color(155, 89, 182);\n    }\n}\n","export class Vec3 {\n    x: number;\n    y: number;\n    z: number;\n\n    constructor(x: number, y: number, z:number) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n\n    public static Zero(): Vec3 {\n        return new Vec3(0, 0, 0);\n    }\n\n    public Length(): number {\n        let a = Math.pow(this.x, 2);\n        let b = Math.pow(this.y, 2);\n        let c = Math.pow(this.z, 2);\n        return Math.sqrt(a + b + c);\n    }\n\n    public Normalized(): Vec3 {\n        let length = this.Length();\n        return new Vec3(\n            this.x / length,\n            this.y / length,\n            this.z / length\n        );\n    }\n\n    public Add(v: Vec3): Vec3 {\n        return new Vec3(\n            this.x + v.x,\n            this.y + v.y,\n            this.z + v.z\n        );\n    }\n\n    public Subtract(v: Vec3): Vec3 {\n        return new Vec3(\n            this.x - v.x,\n            this.y - v.y,\n            this.z - v.z\n        );\n    }\n\n    public ScalarMultiply(k: number): Vec3 {\n        return new Vec3(\n            this.x * k,\n            this.y * k,\n            this.z * k,\n        );\n    }\n\n    public Dot(v: Vec3): number {\n        return this.x * v.x + this.y * v.y + this.z * v.z;\n    }\n}\n","import { Raytracer } from './raytracer';\n\nlet raytracer = new Raytracer(640, 480);\nraytracer.render();\n","import { Viewport } from './viewport'\n\nexport class Raytracer {\n    private viewport: Viewport;\n\n    private div: HTMLDivElement;\n    private clearButton: HTMLButtonElement;\n    private fillRandomButton: HTMLButtonElement;\n    private renderButton: HTMLButtonElement;\n    private saveToPNGButton: HTMLButtonElement;\n\n    constructor(width: number, height: number) {\n        this.div = document.createElement('div');\n        document.body.append(this.div)\n        this.viewport = new Viewport(this.div, width, height);\n\n        this.clearButton = document.createElement('button');\n        this.clearButton.innerText = 'Clear';\n        this.clearButton.onclick = () => this.clear();\n        this.div.appendChild(this.clearButton);\n\n        this.fillRandomButton = document.createElement('button');\n        this.fillRandomButton.innerText = 'fillRandom';\n        this.fillRandomButton.onclick = () => this.fillRandom();\n        this.div.appendChild(this.fillRandomButton);\n\n        this.renderButton = document.createElement('button');\n        this.renderButton.innerText = 'render';\n        this.renderButton.onclick = () => this.render();\n        this.div.appendChild(this.renderButton);\n\n        this.saveToPNGButton = document.createElement('button');\n        this.saveToPNGButton.innerText = 'saveToPNG';\n        this.saveToPNGButton.onclick = () => this.saveToPNG();\n        this.div.appendChild(this.saveToPNGButton);\n    }\n\n    clear() {\n        this.viewport.clear();\n    }\n\n    fillRandom() {\n        this.viewport.fillRandom();\n    }\n\n    render() {\n        this.viewport.render();\n    }\n\n    saveToPNG() {\n        this.viewport.saveToPNG();\n    }\n}\n","import { Ray } from \"./ray\";\nimport { Vec3 } from \"./vec3\";\nimport { Sphere } from \"./sphere\";\nimport { HitInfo } from \"./hitinfo\";\nimport { Color } from \"./color\";\nimport { Light } from \"./light\";\n\nexport class Viewport {\n    private width: number\n    private height: number\n    private canvas: HTMLCanvasElement\n    private context: CanvasRenderingContext2D\n\n    private sphere: Sphere\n    private light: Light\n\n    constructor(parent: HTMLElement, width: number, height: number) {\n        this.width = width;\n        this.height = height;\n\n        this.canvas = document.createElement('canvas');\n        parent.appendChild(this.canvas);\n\n        this.context = this.canvas.getContext('2d');\n        this.canvas.width = this.width;\n        this.canvas.height = this.height;\n        this.clear();\n\n        this.sphere = new Sphere(new Vec3(0, 0, 3), 1, Color.Red());\n        this.light = new Light(new Vec3(1000, 0, 3))\n    }\n\n    clear() {\n        this.context.fillStyle = 'gray';\n        this.context.fillRect(0, 0, this.width, this.height);\n    }\n\n    fillRandom() {\n        let imageData = this.context.getImageData(0, 0, this.width, this.height);\n        for(var i = 0; i < this.width * this.height * 4;) {\n            imageData.data[i+0] = Math.random() * 255;\n            imageData.data[i+1] = Math.random() * 255;\n            imageData.data[i+2] = Math.random() * 255;\n            i += 4;\n        }\n        this.context.putImageData(imageData, 0, 0);\n    }\n\n    render() {\n        let imageData = this.context.getImageData(0, 0, this.width, this.height);\n\n        for (var y: number = 0; y < this.height; y++) {\n            for (var x: number = 0; x < this.width; x++) {\n                let ratio = this.width / this.height;\n\n                //TODO: cast the ray from the center for the pixel\n                let dirX: number = (ratio / this.width) * x - ratio/2;\n                let dirY: number = (1 / this.height) * y - 1/2;\n\n                let ray: Ray = new Ray(new Vec3(0,0,0), new Vec3(dirX, dirY, 1));\n\n                let offset = this.width * y + x;\n\n                let hitInfo: HitInfo = this.sphere.intersect(ray);\n\n                if (hitInfo.hit) {\n                    let pointToLight = this.light.position.Subtract(hitInfo.hitPoint).Normalized();\n\n                    let intensity = Math.max(0, pointToLight.Dot(hitInfo.normal));\n\n                    let hitInfoColor: Color = hitInfo.GetColor();\n\n                    imageData.data[offset * 4 + 0] = hitInfoColor.r * intensity;\n                    imageData.data[offset * 4 + 1] = hitInfoColor.g * intensity;\n                    imageData.data[offset * 4 + 2] = hitInfoColor.b * intensity;\n                }\n            }\n        }\n        this.context.putImageData(imageData, 0, 0); //TODO: the resulting image needs to be vertically flipped\n    }\n\n    saveToPNG() {\n        var newTab = window.open();\n        newTab.document.body.innerHTML = '<img src=\"' + this.canvas.toDataURL() + '\">';\n    }\n}\n","import { Vec3 } from \"./vec3\";\n\nexport class Ray {\n    origin : Vec3;\n    direction : Vec3;\n\n    constructor(origin: Vec3, direction: Vec3) {\n        this.origin = origin;\n        this.direction = direction.Normalized();\n    }\n\n    public CalcPointAtT(t: number): Vec3 {\n        return this.origin.Add(this.direction.ScalarMultiply(t));\n    }\n}\n","import { Primitive } from './primitive'\n\nimport { Vec3 } from './vec3'\nimport { Ray } from './ray'\nimport { HitInfo } from './hitinfo'\nimport { Color } from './color'\n\nexport class Sphere implements Primitive{\n    origin: Vec3\n    radius: number\n    color: Color\n\n    constructor(origin: Vec3, radius: number, color: Color) {\n        this.origin = origin;\n        this.radius = radius;\n        this.color = color;\n    }\n\n    /**\n     * Ray-Sphere Intersection (using the Algebraic Solution)\n     *\n     * Ray: r_o + r_d * t\n     * Sphere: (x_s - x_c)^2 + (y_s - y_c)^2 + (z_s - z_c)^2 = r^2\n     *\n     * (x_o + x_d * t - x_c)^2 + (y_o + y_d * t - y_c)^2 + (z_o + z_d * t - z_c)^2 = r^2\n     *\n     * solve for t\n     * A * t^2 + B * t + C (quadratic equation)\n     * where\n     * A = x_d^2 + y_d^2 + z_d^2\n     * B = 2 * (x_d * (x_o - x_c)+ y_d * (y_o - y_c) + z_d * (z_o - z_c))\n     * C = (x_o - x_c)^2 + (y_o - y_c)^2 + (z_o - z_c)^2 - r^2\n     *\n     * if the quadratic equation discriminant (B^2 - 4AC)\n     *  > 0 then intersect in two points\n     *  = 0 then intersect in one point\n     *  < 0 then there is no intersection\n     *\n     * Use the quadratic formula to find t\n     */\n    intersect(ray: Ray): HitInfo {\n        let x_o = ray.origin.x;\n        let y_o = ray.origin.y;\n        let z_o = ray.origin.z;\n\n        let x_d = ray.direction.x;\n        let y_d = ray.direction.y;\n        let z_d = ray.direction.z;\n\n        let x_c = this.origin.x;\n        let y_c = this.origin.y;\n        let z_c = this.origin.z;\n\n        let r = this.radius;\n\n        let A = x_d ** 2 + y_d ** 2 + z_d ** 2\n        let B = 2 * (x_d * (x_o - x_c)+ y_d * (y_o - y_c) + z_d * (z_o - z_c));\n        let C = (x_o - x_c) ** 2 + (y_o - y_c) ** 2 + (z_o - z_c) ** 2 - r ** 2\n\n        let discriminant = B ** 2 - 4 * A * C;\n\n        if (discriminant >= 0) {\n            let t_0 = ( -B - Math.sqrt(discriminant) ) / 2 * A;\n\n            let x_i = x_o + x_d * t_0;\n            let y_i = y_o + y_d * t_0;\n            let z_i = z_o + z_d * t_0;\n\n            let hitPoint: Vec3 = new Vec3(x_i, y_i, z_i);\n            let normal: Vec3 = new Vec3((x_i - x_c)/r, (y_i - y_c)/r, (z_i - z_c)/r);\n\n            // let color = new Color(\n            //     normal.x * 255,\n            //     normal.y * 255,\n            //     -normal.z * 255,\n            // );\n\n            return new HitInfo(true, hitPoint, normal, new Color(this.color.r, this.color.g, this.color.b));\n        } else {\n            return new HitInfo(false, null, null, null);\n        }\n    }\n}\n","import { Vec3 } from \"./vec3\";\nimport { Color } from \"./color\";\nimport { Consts } from \"./consts\";\n\nexport class HitInfo {\n   hit: boolean\n   hitPoint: Vec3\n   normal: Vec3\n   color: Color\n\n   constructor(hit: boolean, hitPoint: Vec3, normal: Vec3, color: Color) {\n        this.hit = hit;\n        this.hitPoint = hitPoint;\n        this.normal = normal; //TODO: look into Typescript optional types\n        this.color = color;\n    }\n\n    public GetColor() {\n        if (Consts.DEBUG_NORMALS) {\n            return new Color(\n                this.normal.x * 255,\n                this.normal.y * 255,\n                this.normal.z * 255 * -1,\n            );\n        } else {\n            return new Color(\n                this.color.r,\n                this.color.g,\n                this.color.b\n            );\n        }\n    }\n}\n","export class Consts {\n    public static readonly DEBUG_NORMALS = false;\n}\n","import { Vec3 } from \"./vec3\";\n\nexport class Light {\n    public position: Vec3\n\n    constructor(position: Vec3) {\n        this.position = position;\n    }\n}\n"],"sourceRoot":""}